<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ruleta de Bonus | BET300</title>
<meta name="theme-color" content="#0b0f1e"/>

<style>
  :root{
    --bg:#0b0f1e;
    --panel:#121634;
    --panel-2:#0f1330;
    --border:#1e2150;
    --text:#e8ebff;
    --muted:#b7b9d6;
    --primary:#7c4dff;
    --primary-2:#00d1ff;
    --ok:#25D366;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--text); background: var(--bg);
    font: 16px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial;
  }

  /* Fondo con overlay (si no hay imagen, queda el gradiente) */
  body::before{
    content:""; position:fixed; inset:0; z-index:-2;
    background:
      radial-gradient(900px 500px at 50% -10%, rgba(101,74,255,.25), transparent),
      radial-gradient(700px 350px at 100% 0%, rgba(0,209,255,.18), transparent),
      linear-gradient(180deg, #0b0f1e 0%, #0b0f1e 60%, #0a0d20 100%);
  }
  .bg-img{
    position:fixed; inset:0; z-index:-3; opacity:.25; object-fit:cover; width:100%; height:100%;
    filter: saturate(1.1) contrast(1.05) blur(0px);
    display:none; /* ponla en block cuando subas fondo */
  }

  .container{
    max-width:980px; margin:0 auto; padding:18px 14px 28px;
  }
  .card{
    background: radial-gradient(120% 100% at 50% 0%, rgba(124,77,255,.08), rgba(0,0,0,0)) , var(--panel-2);
    border:1px solid var(--border);
    border-radius:18px; padding:18px; box-shadow: 0 15px 40px rgba(0,0,0,.35);
  }
  .card + .card{ margin-top:14px }
  .head{
    display:flex; align-items:center; gap:10px; margin-bottom:6px;
  }
  .brand{ height:28px; width:auto; filter: drop-shadow(0 2px 8px rgba(0,0,0,.4)); }
  .pill{
    background: linear-gradient(90deg, rgba(124,77,255,.15), rgba(0,209,255,.15));
    border:1px solid var(--border); border-radius:999px; padding:6px 10px;
    font-size:12px; color:var(--muted)
  }

  .grid{
    display:grid; gap:16px;
    grid-template-columns: minmax(0,1fr);
  }
  @media (min-width:900px){
    .grid{ grid-template-columns: 1.15fr .85fr }
  }

  /* Escenario de la ruleta */
  .stage{ position:relative; display:flex; align-items:center; justify-content:center; }
  .glow{ position:absolute; inset:0; margin:auto; pointer-events:none; opacity:.75; display:none; }
  /* Canvas responsivo */
  .wheel-wrap{ width:100%; max-width:520px; margin:auto; }
  @media (max-width:420px){ .wheel-wrap{ max-width:420px } }
  @media (max-width:360px){ .wheel-wrap{ max-width:360px } }

  canvas{ width:100%; height:auto; display:block; }

  .pin{
    position:absolute; top:10px; left:50%; transform:translateX(-50%);
    width:28px; height:auto;
    filter: drop-shadow(0 0 6px rgba(0,0,0,.6));
  }

  .panel{
    background: var(--panel);
    border:1px solid var(--border); border-radius:16px; padding:16px;
  }
  .center{ text-align:center }
  h1,h2,h3,p{ margin:0 0 8px }
  h1{ font-size:24px }
  .muted{ color:var(--muted) }

  .stat{
    display:flex; align-items:center; gap:12px; justify-content:center; margin:8px 0 14px;
  }
  .badge{
    width:46px; height:46px; border-radius:12px;
    background: radial-gradient(100% 100% at 50% 0%, rgba(0,209,255,.35), rgba(124,77,255,.35));
    display:grid; place-items:center; font-weight:700; font-size:18px;
    box-shadow: inset 0 0 10px rgba(124,77,255,.35);
  }

  .btn{
    appearance:none; border:none; cursor:pointer;
    padding:12px 16px; border-radius:12px; font-weight:700;
    background: linear-gradient(90deg, #6c59ff, #00d1ff);
    color:#0a1020; width:100%;
    box-shadow: 0 8px 20px rgba(0,0,0,.35);
  }
  .btn:disabled{ opacity:.55; cursor:not-allowed }
  .btn.secondary{
    background: #1a1f4a; color:var(--text); border:1px solid var(--border);
  }
  .btn.ok{
    background: #25D366; color:#0b0f1e;
  }

  .row{ display:flex; gap:10px; }
  .row .btn{ flex:1 }

  .cta{
    display:flex; align-items:center; gap:12px; margin-top:14px;
    padding:12px; border:1px dashed var(--border); border-radius:12px;
    background: linear-gradient(180deg, rgba(124,77,255,.06), rgba(0,0,0,0));
  }
  .agent{ width:40px; height:40px; border-radius:50%; object-fit:cover }
  .cta small{ color:var(--muted); display:block }

  .trust{ display:flex; flex-wrap:wrap; gap:14px; margin-top:12px }
  .trust li{ list-style:none; display:flex; align-items:center; gap:8px; color:var(--muted); font-size:13px }
  .trust img{ width:16px; height:16px; opacity:.9 }

  /* confeti */
  .confetti{ position:fixed; inset:0; pointer-events:none; z-index:40 }
  .confetti i{
    position:absolute; width:10px; height:14px; opacity:0; top:-20px;
    background: linear-gradient(#ffea00,#ff3d7f);
    animation: drop 1.6s linear forwards; transform: rotate(0deg);
    border-radius:2px;
  }
  @keyframes drop{
    8%{ opacity:1 }
    100%{ transform: translateY(110vh) rotate(360deg); opacity:0 }
  }

  /* ticker */
  .ticker{ overflow:hidden; border-radius:12px; border:1px solid var(--border); }
  .ticker .track{ white-space:nowrap; display:inline-block; padding:8px 0; animation: sc 18s linear infinite; }
  .ticker span{ color:#cfd3ff; opacity:.85; margin:0 22px }
  @keyframes sc{ from{transform:translateX(0)} to{transform:translateX(-50%)} }
</style>
</head>
<body>

<!-- (Opcional) si sub√≠s un fondo, cambia style="display:none" a "display:block" -->
<img class="bg-img" src="/img/bg-casino.webp" alt=""/>

<div id="confetti" class="confetti" aria-hidden="true"></div>

<div class="container">
  <div class="card">
    <div class="head">
      <!-- Cambi√° el src por tu logo; si no ten√©s, este SVG m√≠nimo funciona -->
      <img class="brand" src="/img/logo.svg" alt="BET300" onerror="this.outerHTML='<strong>BET300</strong>'">
      <span class="pill">Ruleta de bonus ¬∑ con tu pr√≥xima carga</span>
    </div>

    <!-- Ticker prueba social -->
    <div class="ticker" aria-hidden="true" style="margin:8px 0 14px">
      <div class="track">
        <span>Mica gan√≥ 35%</span><span>|</span>
        <span>Leo gan√≥ 25%</span><span>|</span>
        <span>Fede gan√≥ 40%</span><span>|</span>
        <span>Luz gan√≥ 30%</span><span>|</span>
        <span>Tomi gan√≥ 50%</span><span>|</span>
        <span>Mica gan√≥ 35%</span><span>|</span>
        <span>Leo gan√≥ 25%</span><span>|</span>
        <span>Fede gan√≥ 40%</span><span>|</span>
        <span>Luz gan√≥ 30%</span><span>|</span>
        <span>Tomi gan√≥ 50%</span>
      </div>
    </div>

    <div class="grid">
      <!-- Columna ruleta -->
      <div class="panel">
        <div class="stage">
          <!-- Glow opcional (marco), mostrar√° si sub√≠s /img/glow-frame.svg -->
          <img class="glow" id="glow" src="/img/glow-frame.svg" alt="" onload="this.style.display='block'">
          <div class="wheel-wrap">
            <canvas id="wheel" width="620" height="620"></canvas>
          </div>
          <!-- Pin: reemplazalo por tu /img/pin.svg -->
          <img class="pin" id="pin" src="/img/pin.svg" alt=""/>
        </div>
      </div>

      <!-- Columna info/acciones -->
      <div class="panel">
        <div class="center">
          <div class="stat">
            <div class="badge" id="badge">%</div>
            <div>
              <h1 id="title">Ten√©s 1 giro disponible</h1>
              <p class="muted" id="subtitle">El bonus se acredita con tu <b>pr√≥xima carga m√≠nima</b>.</p>
            </div>
          </div>
        </div>

        <div class="row" style="margin-top:8px">
          <button id="spinBtn" class="btn">üéØ Girar ruleta</button>
          <button id="resetBtn" class="btn secondary">Reiniciar prueba</button>
        </div>

        <button id="claimBtn" class="btn ok" style="margin-top:10px" disabled>
          üì≤ Reclamar bonus con mi carga
        </button>

        <div class="cta">
          <img class="agent" src="/img/agent.png" alt="Agente">
          <div>
            <strong>¬øDudas?</strong>
            <small>Atiende soporte ¬∑ respuesta en 1‚Äì2 min</small>
          </div>
          <a id="wpDirect" class="btn ok" style="margin-left:auto; padding:10px 12px" target="_blank" rel="noopener">Abrir WhatsApp</a>
        </div>

        <ul class="trust">
          <li><img src="/img/badges/secure.svg" alt=""> Pago seguro</li>
          <li><img src="/img/badges/support.svg" alt=""> Soporte 24/7</li>
          <li><img src="/img/badges/fast.svg" alt=""> Acreditaci√≥n r√°pida</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="card center muted" style="font-size:13px">
    <p>Promoci√≥n v√°lida solo con <b>carga m√≠nima</b>. El bonus aplica a la <b>pr√≥xima carga</b> y no es acumulable con otras promos. Sujeto a t√©rminos de la plataforma.</p>
  </div>
</div>

<script>
/* =====================  CONFIG  ======================= */

/* WhatsApp principal (default) y por PC con ?pc=1,2,3 */
const WP_NUMBERS = {
  principal: "5491157737173",  // <-- tu n√∫mero principal (sin +)
  pc1:       "5491138601132",  // <-- PC1 (cambiar)
  pc2:       "5491138214312",  // <-- PC2
  pc3:       "5491168392647"   // <-- PC3
};

/* Mensaje base. %PRIZE% ser√° reemplazado por el premio. */
const WP_MSG = "Hola, gan√© %PRIZE%% de bonus en la ruleta y quiero reclamarlo con mi pr√≥xima carga.";

/* Segmentos de la ruleta (porcentajes) */
const SEGMENTS = [20,25,30,40,50];

/* Colores de cada segmento (ne√≥n casino) */
const COLORS = ["#44e0ff","#7a5bff","#16e2b6","#ff6ad5","#ffd166"];

/* ====================================================== */

const wheel = document.getElementById('wheel');
const ctx = wheel.getContext('2d');
const spinBtn = document.getElementById('spinBtn');
const resetBtn = document.getElementById('resetBtn');
const claimBtn = document.getElementById('claimBtn');
const wpDirect = document.getElementById('wpDirect');
const badge = document.getElementById('badge');
const title = document.getElementById('title');
const subtitle = document.getElementById('subtitle');
const confettiHolder = document.getElementById('confetti');

let angle = 0, spinning=false, prize=null;

/* WhatsApp seg√∫n query ?pc=1/2/3 */
const params = new URLSearchParams(location.search);
const pc = params.get('pc');
let wpTarget = WP_NUMBERS.principal;
if(pc === '1') wpTarget = WP_NUMBERS.pc1 || WP_NUMBERS.principal;
if(pc === '2') wpTarget = WP_NUMBERS.pc2 || WP_NUMBERS.principal;
if(pc === '3') wpTarget = WP_NUMBERS.pc3 || WP_NUMBERS.principal;

/* enlace directo (si a√∫n no hay premio) */
wpDirect.href = `https://wa.me/${wpTarget}`;

/* 1 giro por sesi√≥n */
if(localStorage.getItem('wheel_spun') === '1'){
  prize = parseInt(localStorage.getItem('wheel_prize') || '0',10);
  if(prize){
    setWonState(prize);
    angle = segmentToAngle(prize) + Math.PI*2; // orientar la ruleta al premio
  }else{
    disableSpinMsg();
  }
}
draw(angle);

/* dibuja ruleta */
function draw(a){
  const {width,height} = wheel;
  const cx = width/2, cy = height/2, r = Math.min(cx,cy) - 10;
  ctx.clearRect(0,0,width,height);

  const total = SEGMENTS.length;
  const arc = Math.PI*2 / total;

  for(let i=0;i<total;i++){
    const start = a + i*arc;
    const end = start + arc;
    ctx.beginPath();
    ctx.moveTo(cx,cy);
    ctx.arc(cx,cy,r,start,end,false);
    ctx.closePath();
    ctx.fillStyle = COLORS[i % COLORS.length];
    ctx.fill();

    // separador
    ctx.strokeStyle = "rgba(10,15,35,.35)";
    ctx.lineWidth = 2;
    ctx.stroke();

    // texto
    const label = SEGMENTS[i] + "%";
    ctx.save();
    ctx.translate(cx,cy);
    ctx.rotate(start + arc/2);
    ctx.textAlign = "right";
    ctx.fillStyle = "#091024";
    ctx.font = "bold 44px system-ui, -apple-system, Segoe UI, Roboto";
    ctx.fillText(label, r - 24, 12);
    ctx.restore();
  }

  // disco central
  ctx.beginPath();
  ctx.arc(cx,cy,60,0,Math.PI*2);
  ctx.fillStyle = "#0e1230";
  ctx.fill();
  ctx.strokeStyle = "rgba(124,77,255,.6)";
  ctx.lineWidth = 4;
  ctx.stroke();
}

/* mapea premio a √°ngulo del segmento */
function segmentToAngle(pct){
  const idx = SEGMENTS.indexOf(pct);
  const total = SEGMENTS.length;
  const arc = Math.PI*2 / total;
  const base = (Math.PI*1.5) - (arc/2); // arriba
  return base - idx*arc;
}

/* gira */
spinBtn.addEventListener('click', ()=>{
  if(spinning) return;
  if(localStorage.getItem('wheel_spun') === '1') return disableSpinMsg();

  spinning = true;
  spinBtn.disabled = true;

  // ganador al azar
  const win = SEGMENTS[Math.floor(Math.random()*SEGMENTS.length)];
  prize = win;

  const finalAngle = segmentToAngle(win) + Math.PI*2*6 + (Math.random()>.5?0.02:-0.02); // vueltas + leve variaci√≥n
  animateTo(finalAngle, 2800, ()=>{
    setWonState(win);
    localStorage.setItem('wheel_spun','1');
    localStorage.setItem('wheel_prize', String(win));
    spinning = false;
  });
});

/* animaci√≥n simple */
function animateTo(target, ms, cb){
  const start = performance.now();
  const from = angle;
  (function loop(t){
    const k = Math.min(1, (t-start)/ms);
    const ease = 1 - Math.pow(1-k,3); // easeOutCubic
    angle = from + (target - from) * ease;
    draw(angle);
    if(k<1) requestAnimationFrame(loop);
    else cb && cb();
  })(start);
}

/* estado ‚Äúganado‚Äù */
function setWonState(win){
  badge.textContent = win + "%";
  title.textContent = `üéâ ¬°Ganaste ${win}% de bonus!`;
  subtitle.innerHTML = `Usalo <b>con tu pr√≥xima carga</b>.`;

  claimBtn.disabled = false;
  const msg = WP_MSG.replace("%PRIZE%", String(win));
  claimBtn.onclick = ()=> {
    location.href = `https://wa.me/${wpTarget}?text=${encodeURIComponent(msg)}`;
  };

  // bot√≥n directo de soporte
  wpDirect.href = `https://wa.me/${wpTarget}?text=${encodeURIComponent("Hola, tengo una consulta sobre mi bonus.")}`;

  burstConfetti();
}

/* si ya gir√≥ */
function disableSpinMsg(){
  spinBtn.disabled = true;
  title.textContent = "¬°Ya usaste tu giro!";
  subtitle.textContent = "Reclam√° tu bonus por WhatsApp.";
}

/* reset */
resetBtn.addEventListener('click', ()=>{
  localStorage.removeItem('wheel_spun');
  localStorage.removeItem('wheel_prize');
  prize = null; angle = 0; draw(angle);
  spinBtn.disabled = false;
  claimBtn.disabled = true;
  badge.textContent = "%";
  title.textContent = "Ten√©s 1 giro disponible";
  subtitle.innerHTML = `El bonus se acredita con tu <b>pr√≥xima carga m√≠nima</b>.`;
});

/* confeti */
function burstConfetti(){
  confettiHolder.innerHTML = '';
  const n = 26;
  for(let i=0;i<n;i++){
    const p = document.createElement('i');
    p.style.left = (Math.random()*100)+'vw';
    p.style.animationDelay = (Math.random()*0.5)+'s';
    p.style.background = Math.random()<.5
      ? 'linear-gradient(#80ffea,#4e9cff)'
      : 'linear-gradient(#ffd166,#ff3d7f)';
    confettiHolder.appendChild(p);
  }
  setTimeout(()=> confettiHolder.innerHTML = '', 1800);
}
</script>
</body>
</html>
